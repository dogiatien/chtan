@{
    ViewBag.Title = "Home Page";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
    <link rel="stylesheet" type="text/css" href="~/Content/css/trangchucss.css">
    var taikhoan = Session["taikhoan"] as string;
}
<body>

    <div class="banner-container">
        <div class="banner-slides">
            @foreach (var image in ViewBag.list)
            {
                <div class="banner-slide">
                    <img src="~/Content/Hinh/@image[4]" alt="@image[4]" />
                </div>
            }
        </div>
    </div>
    @*<div style="width: 80%; height: 400px; background-color: #FFEAE9;border-radius:9px;margin-right:auto;margin-left:auto; display:flex">
        <div class="qc">
            <div>
                <img src="~/Content/Hinh/tiec.png" style="height:200px;width:200px;margin-top:auto;margin-bottom:auto" />
                <div>Nhận đặt tiệc</div>
            </div>
        </div>
        <div class="qc">
            <div>
                <img src="~/Content/Hinh/tiec.png" style="height:200px;width:200px;" />
                <div>Free Ship</div>
            </div>
        </div>
        <div class="qc">
            <div>
                <img src="~/Content/Hinh/tiec.png" style="height:200px;width:200px;margin-top:auto;margin-bottom:auto" />
                <div>Khuyến Mãi Khủng</div>
            </div>
        </div>

    </div>*@
    <div class="container">
        <div class="category-container">
            <label for="categorySelect">Danh mục món ăn:</label>
            <select id="categorySelect" onchange="filterProducts()">
                <option value="">Tất cả</option>
                @foreach (var category in ViewBag.listloai)
                {
                    <option value="@category[0]">@category[1]</option>
                }
            </select>
        </div>

        @foreach (var category in ViewBag.listloai)
        {
            <p id="category-@category[0]" style="font-family: system-ui; font-size: 30px; font-weight: 700;"> @category[1]</p><br />
            <div class="product-container" id="productContainer-@category[0]">
                @foreach (var a in ViewBag.list)
                {
                    if (a[5] == category[0])
                    {
                        <div class="product-item" data-category="@a[5]">
                            <img style="height:200px;width:200px;" src="~/Content/Hinh/@a[4]" alt="@a[1]" class="product-image" />
                            <h3 class="product-title">@a[1]</h3>
                            <p class="product-description">@a[2]</p>
                            <p class="product-price">Giá: @a[3]</p>
                            <div class="button-container">
                                @if (Session["taikhoan"] == null)
                                {
                                    <!-- Nếu người dùng chưa đăng nhập, hiển thị nút Đăng nhập -->
                                    <a style="text-decoration:0"class="addcart" href="~/Home/Login">Thêm vào giỏ hàng</a>

                                }
                                else
                                {
                                    <!-- Nếu người dùng đã đăng nhập, hiển thị nút Thêm vào giỏ hàng -->
                                    System.Collections.ArrayList b = ((System.Collections.ArrayList)Session["taikhoan"]);
                                    <form action="@Url.Action("AddToCart", "Cart")" method="post">
                                        <input type="hidden" name="idma" value="@a[0]" />
                                        <input type="hidden" name="idtk" value="@b[0]" />
                                        <button class="addcart" type="submit">Thêm vào giỏ hàng</button>
                                    </form>
                                }
                            </div>
                        </div>
                    }
                }
            </div>
        }
    </div>

    <script>
        function filterProducts() {
            var categorySelect = document.getElementById("categorySelect");
            var selectedCategory = categorySelect.value;

            var productItems = document.getElementsByClassName("product-item");

            for (var i = 0; i < productItems.length; i++) {
                var productItem = productItems[i];
                var categoryId = productItem.getAttribute("data-category");

                if (selectedCategory === "" || categoryId === selectedCategory) {
                    productItem.style.display = "grid";
                }
            }

            // Hiển thị tất cả các sản phẩm trong danh mục đã chọn
            var selectedCategoryItems = document.querySelectorAll(".product-item[data-category='" + selectedCategory + "']");
            for (var j = 0; j < selectedCategoryItems.length; j++) {
                selectedCategoryItems[j].style.display = "grid";
            }

            // Cuộn xuống vị trí danh mục đồ ăn tương ứng
            var categoryElement = document.getElementById("category-" + selectedCategory);
            if (categoryElement) {
                categoryElement.scrollIntoView({ behavior: "smooth" });
            }
        }


    </script>
</body>
